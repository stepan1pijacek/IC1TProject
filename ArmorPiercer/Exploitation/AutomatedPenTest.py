import re
import subprocess as sp


class CreateProcess:
    def __init__(self, pwd, bank_number, amount, program_path):
        self.pwd = pwd
        self.bank_number = bank_number
        self.amount = amount
        self.program_path = program_path

    def start_process(self):
        process = sp.Popen([self.program_path], stdout=sp.PIPE, stdin=sp.PIPE)
        current_console_out = process.stdout.readline()

        if not re.match("password|login", current_console_out.decode("utf-8")):
            return "Failed, application did not start"

        process.stdin.write(b"aaaaaaaaaaaaaaaaaaaaaaaaaaa\n")
        current_console_out = process.stdout.readline()

        if not re.match("bank account", current_console_out.decode("utf-8")):
            process.stdin.write(b"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n")
            return "Failed to authenticate. Will try again"

